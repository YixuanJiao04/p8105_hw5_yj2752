---
title: "P8105_hw5_yj2752"
author: "Yixuan Jiao"
output: github_document
---

```{r}
library(purrr)
library(tidyverse)
```


## Problem1
Reading all csv merge them into a single file
```{r}
exp_table <- 
  tibble(id = list.files("./data")) %>%
  mutate(file_dir = str_c("./data/",id)) %>%
  mutate(data = map(file_dir, read_csv)) %>%
  unnest(data)
```
Tidy the table
```{r}
exp_table_tidy <- 
  exp_table %>%
  select(-file_dir) %>%
  mutate(id = str_replace(id,".csv","")) %>%
  separate(id,into = c("group","id"), sep = "_") %>%
  pivot_longer(week_1:week_8,names_to = "week", names_prefix = "week_",values_to = "data") 
```

## Problem2
The data is loaded using `read_csv()`.
```{r}
homicide <- read_csv("./data/homicide-data.csv")
```
The raw data contain the victim's basic information(name,race,age,sex), and location and status of the case. Detail descriptive data is generated by `skimr::skim()` below.
```{r}
skimr::skim(homicide)
```
Adding `city_state` column
```{r}
homicide <- 
  homicide %>%
  mutate(city_state = str_c(city,",",state))
```
Generate the table of number of unsolved cases by cities
```{r}
unsolved <-
  homicide %>%
  filter(disposition != "Closed by arrest") %>%
  group_by(city_state) %>%
  summarise(unsolved = n())
```
Generate the table of number of total cases by cities then bind two tables together.
```{r}
total <-
  homicide %>%
    group_by(city_state) %>%
    summarise(total = n())
cases_prop <- 
  full_join(total,unsolved) %>%
  replace(is.na(.),0)
```

```{r}

```

